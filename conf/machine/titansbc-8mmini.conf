#@TYPE: Machine
#@NAME: SoMLabs i.MX8MM TitanSBC-8Mmini
#@SOC: i.MX8MM
#@DESCRIPTION: Machine configuration for TitanSBC-8Mmini boards
##@MAINTAINER: Krzysztof Chojnowski <krzysztof.chojnowski@somlabs.com>

MACHINEOVERRIDES =. "mx8:mx8m:mx8mm:"

require conf/machine/include/imx-base.inc
require conf/machine/include/arm/armv8a/tune-cortexa53.inc

UBOOT_CONFIG ??= "sd"
UBOOT_CONFIG[sd] = "titansbc_8mmini_defconfig,sdcard"
SPL_BINARY = "spl/u-boot-spl.bin"

DDR_FIRMWARE_NAME = "lpddr4_pmu_train_1d_imem.bin lpddr4_pmu_train_1d_dmem.bin lpddr4_pmu_train_2d_imem.bin lpddr4_pmu_train_2d_dmem.bin"

UBOOT_DTB_NAME = "imx8mm-titansbc.dtb"
UBOOT_SUFFIX = "bin"

IMXBOOT_TARGETS = "flash_evk"

IMX_BOOT_SOC_TARGET = "iMX8MM"

PREFERRED_PROVIDER_virtual/kernel = "linux-imx"
PREFERRED_VERSION_virtual/kernel = "6.1.36"
PREFERRED_PROVIDER_virtual/bootloader = "u-boot-imx"

SERIAL_CONSOLES = "115200;ttymxc3"

IMAGE_BOOTLOADER = "imx-boot"

ATF_PLATFORM = "imx8mm"
ATF_LOAD_ADDR = "0x920000"

LOADADDR = ""
IMX_BOOT_SEEK = "33"

IMAGE_BOOT_FILES = " \
        ${KERNEL_IMAGETYPE} \
        ${@make_dtb_boot_files(d)} \
"

KERNEL_DEVICETREE = "freescale/titansbc-8mmini.dtb"

MACHINE_FEATURES += " pci wifi bluetooth "
MACHINE_EXTRA_RRECOMMENDS += "linux-firmware-murata-1dx"

BCM_FIRMWARE_SUFFIX = "somlabs,visionsom-8mmini"
